<!-- partials/sites.html -->
<div class="site-cards-container row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
    {% for site_name, site_data in sites.items() %}
    <div class="col">
        <div class="card h-100 site-card" onclick="loadSiteDetail('{{ site_name }}')" style="cursor:pointer;">
            {% if site_data.logo %}
            <img src="{{ site_data.logo }}" class="card-img-top" alt="{{ site_data.name or site_name }} logo">
            {% endif %}
            <div class="card-body">
                <h5 class="card-title">{{ site_data.name or site_name }}</h5>
                <p class="card-text">Language: {{ site_data.language }}</p>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<script>
function loadSiteDetail(siteName) {
    fetch(`/load/site/${siteName}`)
        .then(response => response.text())
        .then(html => {
            const container = document.getElementById('site-detail-container');
            container.innerHTML = html;
            const scripts = container.querySelectorAll('script');
            scripts.forEach(oldScript => {
                const newScript = document.createElement('script');
                if (oldScript.src) {
                    newScript.src = oldScript.src;
                } else {
                    newScript.textContent = oldScript.textContent;
                }
                document.body.appendChild(newScript);
                oldScript.remove();
            });
        })
        .catch(error => console.error('Error loading site detail:', error));
}
</script>